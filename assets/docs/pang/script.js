const PLATFORMS_LIST={level1:[{position:{x:510,y:450},width:60,height:158,exist:!0,isDestructible:!1}],level2:[{position:{x:830,y:200},width:150,height:30,exist:!0,isDestructible:!1},{position:{x:635,y:200},width:80,height:30,exist:!0,isDestructible:!0},{position:{x:490,y:200},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:350,y:200},width:80,height:30,exist:!0,isDestructible:!0},{position:{x:100,y:200},width:150,height:30,exist:!0,isDestructible:!1}],level3:[{position:{x:650,y:200},width:80,height:30,exist:!0,isDestructible:!0},{position:{x:550,y:200},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:450,y:200},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:350,y:200},width:80,height:30,exist:!0,isDestructible:!0},{position:{x:750,y:30},width:30,height:100,exist:!0,isDestructible:!0},{position:{x:750,y:135},width:30,height:95,exist:!0,isDestructible:!0},{position:{x:300,y:30},width:30,height:100,exist:!0,isDestructible:!0},{position:{x:300,y:135},width:30,height:95,exist:!0,isDestructible:!0}],level4:[{position:{x:200,y:0},width:16,height:200,exist:!0,isDestructible:!1},{position:{x:200,y:200},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:200,y:300},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:416,y:0},width:16,height:200,exist:!0,isDestructible:!1},{position:{x:416,y:200},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:416,y:300},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:632,y:0},width:16,height:200,exist:!0,isDestructible:!1},{position:{x:632,y:200},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:632,y:300},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:848,y:0},width:16,height:200,exist:!0,isDestructible:!1},{position:{x:848,y:200},width:16,height:100,exist:!0,isDestructible:!0},{position:{x:848,y:300},width:16,height:100,exist:!0,isDestructible:!0}],level5:[{position:{x:990,y:400},width:90,height:30,exist:!0,isDestructible:!1},{position:{x:820,y:400},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:620,y:400},width:200,height:30,exist:!0,isDestructible:!0},{position:{x:540,y:400},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:460,y:400},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:260,y:400},width:200,height:30,exist:!0,isDestructible:!0},{position:{x:180,y:400},width:80,height:30,exist:!0,isDestructible:!1},{position:{x:0,y:400},width:90,height:30,exist:!0,isDestructible:!1}],level6:[{position:{x:180,y:400},width:900,height:30,exist:!0,isDestructible:!1},{position:{x:0,y:400},width:90,height:30,exist:!0,isDestructible:!1},{position:{x:0,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:150,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:300,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:450,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:600,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:750,y:200},width:150,height:30,exist:!0,isDestructible:!0},{position:{x:990,y:200},width:150,height:30,exist:!0,isDestructible:!0}],level7:[{position:{x:216,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:310,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:405,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:595,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:690,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:785,y:300},width:80,height:20,exist:!0,isDestructible:!1},{position:{x:530,y:130},width:20,height:75,exist:!0,isDestructible:!1},{position:{x:530,y:215},width:20,height:75,exist:!0,isDestructible:!1},{position:{x:530,y:330},width:20,height:75,exist:!0,isDestructible:!1},{position:{x:530,y:415},width:20,height:75,exist:!0,isDestructible:!1}],level8:[{position:{x:0,y:150},width:110,height:58,exist:!0,isDestructible:!1},{position:{x:200,y:300},width:110,height:58,exist:!0,isDestructible:!1},{position:{x:400,y:450},width:95,height:58,exist:!0,isDestructible:!1},{position:{x:585,y:450},width:95,height:58,exist:!0,isDestructible:!1},{position:{x:770,y:300},width:110,height:58,exist:!0,isDestructible:!1},{position:{x:970,y:150},width:200,height:58,exist:!0,isDestructible:!1}],level9:[],level10:[{position:{x:100,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:150,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:200,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:250,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:300,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:350,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:400,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:450,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:500,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:550,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:600,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:650,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:700,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:750,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:800,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:850,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:900,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:950,y:90},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:200,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:250,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:300,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:350,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:400,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:600,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:650,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:700,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:750,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:800,y:300},width:45,height:20,exist:!0,isDestructible:!1},{position:{x:175,y:115},width:20,height:90,exist:!0,isDestructible:!0},{position:{x:175,y:207},width:20,height:90,exist:!0,isDestructible:!0},{position:{x:850,y:115},width:20,height:90,exist:!0,isDestructible:!0},{position:{x:850,y:207},width:20,height:90,exist:!0,isDestructible:!0}]},LADDER_WIDTH=90,LADDERS_LIST={level1:[{position:{x:410,y:450},width:90,height:158},{position:{x:580,y:450},width:90,height:158}],level2:[],level3:[],level4:[],level5:[{position:{x:90,y:400},width:90,height:208},{position:{x:900,y:400},width:90,height:208}],level6:[{position:{x:90,y:400},width:90,height:208},{position:{x:900,y:200},width:90,height:200}],level7:[],level8:[{position:{x:110,y:150},width:90,height:208},{position:{x:310,y:300},width:90,height:208},{position:{x:495,y:450},width:90,height:208},{position:{x:680,y:300},width:90,height:208},{position:{x:880,y:150},width:90,height:208}],level9:[],level10:[]},BALLOON_SIZE=[{number:0,radius:0,Yvelocity:0},{number:1,radius:15,Yvelocity:-6},{number:2,radius:30,Yvelocity:-7},{number:3,radius:40,Yvelocity:-8},{number:4,radius:50,Yvelocity:-9.5}],BALLOONS_LIST={level1:[{center:{x:400,y:30},size:BALLOON_SIZE[4],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}}],level2:[{center:{x:400,y:30},size:BALLOON_SIZE[4],velocity:{x:-.8,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:500,y:30},size:BALLOON_SIZE[4],velocity:{x:.8,y:0},gravity:{x:0,y:9.81/1e3}}],level3:[{center:{x:400,y:30},size:BALLOON_SIZE[3],velocity:{x:-.8,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:500,y:30},size:BALLOON_SIZE[4],velocity:{x:.5,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:600,y:30},size:BALLOON_SIZE[2],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}}],level4:[{center:{x:300,y:30},size:BALLOON_SIZE[3],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:525,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:750,y:30},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}}],level5:[{center:{x:400,y:30},size:BALLOON_SIZE[4],velocity:{x:-.75,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:500,y:30},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:600,y:30},size:BALLOON_SIZE[4],velocity:{x:.75,y:0},gravity:{x:0,y:9.81/1e3}}],level6:[{center:{x:200,y:30},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:400,y:30},size:BALLOON_SIZE[3],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:600,y:30},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:800,y:30},size:BALLOON_SIZE[3],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}}],level7:[{center:{x:325,y:90},size:BALLOON_SIZE[4],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:520,y:30},size:BALLOON_SIZE[4],velocity:{x:-.6,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:560,y:30},size:BALLOON_SIZE[4],velocity:{x:.6,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:750,y:90},size:BALLOON_SIZE[4],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}}],level8:[{center:{x:60,y:100},size:BALLOON_SIZE[4],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:240,y:260},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:430,y:412},size:BALLOON_SIZE[2],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:645,y:412},size:BALLOON_SIZE[2],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:820,y:260},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:1020,y:100},size:BALLOON_SIZE[4],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}}],level9:[{center:{x:0,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:140,y:30},size:BALLOON_SIZE[2],velocity:{x:0,y:.8},gravity:{x:0,y:9.81/1e3}},{center:{x:240,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:1.6},gravity:{x:0,y:9.81/1e3}},{center:{x:340,y:30},size:BALLOON_SIZE[2],velocity:{x:0,y:2.4},gravity:{x:0,y:9.81/1e3}},{center:{x:440,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:3.2},gravity:{x:0,y:9.81/1e3}},{center:{x:640,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:3.2},gravity:{x:0,y:9.81/1e3}},{center:{x:740,y:30},size:BALLOON_SIZE[2],velocity:{x:0,y:2.4},gravity:{x:0,y:9.81/1e3}},{center:{x:840,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:1.6},gravity:{x:0,y:9.81/1e3}},{center:{x:940,y:30},size:BALLOON_SIZE[2],velocity:{x:0,y:.8},gravity:{x:0,y:9.81/1e3}},{center:{x:1040,y:30},size:BALLOON_SIZE[3],velocity:{x:0,y:0},gravity:{x:0,y:9.81/1e3}}],level10:[{center:{x:480,y:30},size:BALLOON_SIZE[3],velocity:{x:-1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:600,y:30},size:BALLOON_SIZE[3],velocity:{x:1,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:350,y:200},size:BALLOON_SIZE[4],velocity:{x:.5,y:0},gravity:{x:0,y:9.81/1e3}},{center:{x:750,y:200},size:BALLOON_SIZE[4],velocity:{x:-.5,y:0},gravity:{x:0,y:9.81/1e3}}]};var context=null,numLevel=0;const MAX_LEVEL=10;var isOnFocus=!0,pause=!1,victory=!1,defeat=!1,isInvincible=!1,easterEgg=!1,timer=100,balloonsFreezeTimer=Date.now(),areBalloonsFreeze=!1,shieldTimer=Date.now(),playerBlinkTimer=Date.now(),balloonBlinkTimer=Date.now(),balloons=[];const BALLOON_SPEED=.1;var lastUpdate=Date.now(),player={position:{x:0,y:0},speed:{x:0,y:0},height:0,width:0,powerOn:0,shieldOn:!1,score:0,livesNumber:3,color:"blue"};const PLAYER_SPEED=500,GRAVITY={x:0,y:1500};var isGravity=0,player_last_direction=0,weapons=[];const GRAPPLE_HOOK_NUMBER=1,DOUBLE_HOOK_NUMBER=2,TRIDENT_NUMBER=3,HOOK_SPEED=.3,BULLET_SPEED=.3,HOOK_WITDH=5,GUN_NUMBER=4;var platforms=[],ladders=[],clic={x:0,y:0},items=[];const GRAPPLE_HOOK_ITEM=GRAPPLE_HOOK_NUMBER,DOUBLE_HOOK_ITEM=DOUBLE_HOOK_NUMBER,TRIDENT_ITEM=TRIDENT_NUMBER,GUN_ITEM=GUN_NUMBER,TIMER_BOOST_ITEM=5,DYNAMITE_ITEM=6,FREEZE_ITEM=7,SHIELD_ITEM=8,MAX_ITEM=8;var margin=60,marginButton=75,widthButton=132,heightButton=40;const DESTRUCTIBLE_PLATFORM_COLOR="#f47b3e",PLATFORM_COLOR="#a5260a",LADDERS_IMAGE=new Image;var BALLOON_COLOR,BALLON_GRADIENT;LADDERS_IMAGE.src="./assets/Ladders.png";const EASTER_BUNNY=new Image;EASTER_BUNNY.src="./assets/lapin.png";const EASTER_EGG=new Image;EASTER_EGG.src="./assets/easterEgg.png";const GRAPPLE_HOOK_COLOR="red",TRIDENT_COLOR1="orangered",TRIDENT_COLOR2="orange",TRIDENT_COLOR3="yellow",GRAPPLE_HOOK_ITEM_COLOR="red",DOUBLE_HOOK_ITEM_IMAGE=new Image;DOUBLE_HOOK_ITEM_IMAGE.src="./assets/double_hook_item.png";const TRIDENT_ITEM_IMAGE=new Image;TRIDENT_ITEM_IMAGE.src="./assets/trident.png";const TIMER_BOOST_ITEM_IMAGE=new Image;TIMER_BOOST_ITEM_IMAGE.src="./assets/item_timer_bonus.png";const SHIELD_ITEM_IMAGE=new Image;var BACKGROUND_IMAGE;SHIELD_ITEM_IMAGE.src="./assets/item_shield.png";const PLAYER_IMAGE_LEFT=new Image;PLAYER_IMAGE_LEFT.src="./assets/player_left.png";const PLAYER_IMAGE_RIGHT=new Image;PLAYER_IMAGE_RIGHT.src="./assets/player_right.png";const DOUBLE_HOOK_IMAGE=new Image;DOUBLE_HOOK_IMAGE.src="./assets/double_hook.png";const TRIDENT_IMAGE=new Image;TRIDENT_IMAGE.src="./assets/trident.png";const DYNAMITE_IMAGE=new Image;DYNAMITE_IMAGE.src="./assets/dynamite.png";const FREEZE_IMAGE=new Image;FREEZE_IMAGE.src="./assets/item_freeze.png";const SHIELD_IMAGE=new Image;function levelInitialization(e){switch(player.position.x=context.width/2-player.width/2,player.position.y=context.height-player.height,player.height=70,player.width=45,player.powerOn=GRAPPLE_HOOK_NUMBER,player.shieldOn=!1,e){case 2:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level2)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level2)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level2)),BALLOON_COLOR="blue",cvs.style.background="url('assets/bg_citadelle.jpg')";break;case 3:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level3)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level3)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level3)),BALLOON_COLOR="green",cvs.style.background="url('assets/bg_saline.jpg')";break;case 4:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level4)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level4)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level4)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_lion.jpg')";break;case 5:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level5)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level5)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level5)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_joux.jpg')";break;case 6:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level6)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level6)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level6)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_metabief.jpg')";break;case 7:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level7)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level7)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level7)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_musee.jpg')";break;case 8:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level8)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level8)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level8)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_gouffre.jpg')";break;case 9:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level9)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level9)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level9)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_cascade.jpg')";break;case 10:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level10)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level10)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level10)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_fromages.jpg')";break;default:ladders=JSON.parse(JSON.stringify(LADDERS_LIST.level1)),platforms=JSON.parse(JSON.stringify(PLATFORMS_LIST.level1)),balloons=JSON.parse(JSON.stringify(BALLOONS_LIST.level1)),BALLOON_COLOR="red",cvs.style.background="url('assets/bg_fac.jpg')",player.position.x=context.width/4}timer=100,weapons=[],items=[],victory=!1,defeat=!1}function detectLevelButton(){var e=-1,t=0;do{clic.x>=margin+t*(widthButton+marginButton)&&clic.x<=margin+t*(widthButton+marginButton)+widthButton?e=clic.y<=440?t+1:t+6:t++}while(t<5&&-1==e);return e}function playerMove(e){switch(e){case 39:player.speed.x=PLAYER_SPEED;break;case 37:player.speed.x=-PLAYER_SPEED}}function playerStopMove(e){switch(e){case 39:player.speed.x>0&&(player.speed.x=0);break;case 37:player.speed.x<0&&(player.speed.x=0)}}function playerStopMoveLadder(){player.speed.y=0}function findLadder(e){for(var t=0,i=!1;t<ladders.length&&!i;)e.position.x>=ladders[t].position.x-.33*e.width&&e.position.x<=ladders[t].position.x+ladders[t].width-.66*e.width&&e.position.y>=ladders[t].position.y-1.1*e.height&&e.position.y<=ladders[t].position.y+ladders[t].height?i=!0:t++;return t==ladders.length&&(t=-1),t}function detectPlatform(e){for(var t=0,i=0;i<platforms.length;i++)(!platforms[i].exist||e.position.x+e.width<platforms[i].position.x||e.position.x>platforms[i].position.x+platforms[i].width||e.position.y>=platforms[i].position.y+platforms[i].height||e.position.y+e.height<platforms[i].position.y)&&t++;return t<platforms.length}function isNotOnPlatformOrGround(e){return isNot=!1,e.position.y+e.height<context.height&&-1==findLadder(e)&&0==detectPlatform(e)&&(isNot=!0),isNot}function drawFinalMessage(e){var t;"victory"==e?(context.fillStyle="rgb(51, 138, 52, .75)",t="VICTOIRE !"):player.livesNumber>1?(context.fillStyle="rgb(171, 0, 13, .75)",t="TOUCHÉ..."):(context.fillStyle="rgb(171, 0, 13, .75)",t="PERDU !   SCORE : "+player.score),context.shadowBlur=15,context.shadowColor="black",context.fillRect(context.width/5,(context.height-150)/2,context.width/5*3,150),context.shadowBlur=0,context.fillStyle="white",context.font="48px sans-serif",context.fillText(t,(context.width-context.measureText(t).width)/2,context.height/2+24)}function keepPlayerWithinBorder(){player.position.x<0?player.position.x=0:player.position.x>context.width-player.width&&(player.position.x=context.width-player.width),player.position.y<0?player.position.y=0:player.position.y>context.height-player.height&&(player.position.y=context.height-player.height)}function isPlayerWithinObject(e,t,i,o){var s=!1;return o.exist&&(t+e.width<o.position.x||t>o.position.x+o.width||i+e.height<=o.position.y||i>=o.position.y+o.height||(s=!0)),s}function keepBalloonWithinBorders(e){var t=!1;return e.center.y<e.size.radius?(e.center.y=e.size.radius,e.velocity.y=-e.velocity.y,t=!0):e.center.y>cvs.height-e.size.radius&&(e.center.y=cvs.height-e.size.radius,e.velocity.y=e.size.Yvelocity,t=!0),e.center.x<e.size.radius?(e.center.x=e.size.radius,e.velocity.x=-e.velocity.x,t=!0):e.center.x>cvs.width-e.size.radius&&(e.center.x=cvs.width-e.size.radius,e.velocity.x=-e.velocity.x,t=!0),t}function updateCircleColor(e){switch(BALLON_GRADIENT=context.createRadialGradient(e.center.x-e.size.radius/3,e.center.y-e.size.radius/3,e.size.radius/5,e.center.x,e.center.y,e.size.radius),BALLOON_COLOR){case"blue":BALLON_GRADIENT.addColorStop(0,"#5e92f3"),BALLON_GRADIENT.addColorStop(.2,"#1565c0"),BALLON_GRADIENT.addColorStop(1,"#003c8f");break;case"red":BALLON_GRADIENT.addColorStop(0,"#ff7961"),BALLON_GRADIENT.addColorStop(.2,"#f44336"),BALLON_GRADIENT.addColorStop(1,"#ab000d");break;case"green":BALLON_GRADIENT.addColorStop(0,"#76d275"),BALLON_GRADIENT.addColorStop(.2,"#43a047"),BALLON_GRADIENT.addColorStop(1,"#00701a")}}function fillCircle(e){updateCircleColor(e),context.beginPath(),easterEgg?(context.drawImage(EASTER_EGG,e.center.x-e.size.radius,e.center.y-e.size.radius,2*e.size.radius,2*e.size.radius),context.arc(e.center.x,e.center.y,e.size.radius,0,2*Math.PI)):(context.fillStyle=BALLON_GRADIENT,context.arc(e.center.x,e.center.y,e.size.radius,0,2*Math.PI),context.fill())}function isVictory(){for(var e=!1,t=0;t<balloons.length&&!e;)balloons[t].size.number>0&&(e=!0),t++;return!e}function isDefeat(e){var t=!1;return timer<=1&&!isVictory()?t=!0:e.size.number>0&&collisionsWithPlayer(e,player)&&!isInvincible&&(player.shieldOn?(player.shieldOn=!1,isInvincible=!0,shieldTimer=Date.now(),e.size.number>1?splitBalloon(e):e.size=BALLOON_SIZE[e.size.number-1],playerBlinkTimer=Date.now()):t=!0),t}function isWeaponBetweenX(e,t){return!(e.position.x+HOOK_WITDH<t.position.x||e.position.x>t.position.x+t.width)}function shootWeapon(e){switch(e.powerOn){case GRAPPLE_HOOK_NUMBER:case DOUBLE_HOOK_NUMBER:case TRIDENT_NUMBER:shootGrappleHook();break;case GUN_NUMBER:shootGun()}}function shootGrappleHook(){(0==weapons.length||weapons.length<2&&player.powerOn==DOUBLE_HOOK_NUMBER)&&(weapons[weapons.length]={type:player.powerOn,shooting:!0,position:{x:player.position.x+player.width/2,y:player.position.y+player.height},length:player.height,time:0})}function shootGun(){weapons[weapons.length]={type:player.powerOn,shooting:!0,position:{x:player.position.x+player.width/2,y:player.position.y+player.height},length:20,time:0}}function deleteWeapon(){weapons=[]}function deleteStoppedWeapons(){var e=weapons.filter(e=>e.shooting);weapons=e}function stopWeapon(e){if(e.position.y-e.length<0)switch(e.type){case GRAPPLE_HOOK_NUMBER:deleteWeapon();break;case DOUBLE_HOOK_NUMBER:e.shooting=!1,deleteStoppedWeapons();break;case TRIDENT_NUMBER:e.shooting=!1,e.time>3&&deleteWeapon();break;case GUN_NUMBER:e.shooting=!1,deleteStoppedWeapons()}else for(var t=0;t<platforms.length;t++)if(platforms[t].exist&&isWeaponBetweenX(e,platforms[t])&&e.position.y-e.length<platforms[t].position.y+platforms[t].height&&e.position.y>platforms[t].position.y)switch(e.type){case GRAPPLE_HOOK_NUMBER:e.shooting=!1,deleteWeapon(),platforms[t].isDestructible&&(platforms[t].exist=!1);break;case DOUBLE_HOOK_NUMBER:e.shooting=!1,deleteStoppedWeapons(),platforms[t].isDestructible&&(platforms[t].exist=!1);break;case TRIDENT_NUMBER:e.shooting=!1,platforms[t].isDestructible?(platforms[t].exist=!1,deleteWeapon()):e.time>3&&deleteWeapon();break;case GUN_NUMBER:e.shooting=!1,platforms[t].isDestructible&&(platforms[t].exist=!1),deleteStoppedWeapons()}for(t=0;t<balloons.length;t++)if(balloons[t].size.number>0&&Math.pow(balloons[t].center.x-e.position.x,2)<Math.pow(balloons[t].size.radius,2)&&balloons[t].center.y+balloons[t].size.radius>e.position.y-e.length&&balloons[t].center.y+balloons[t].size.radius<e.position.y){switch(e.type){case GRAPPLE_HOOK_NUMBER:case TRIDENT_NUMBER:deleteWeapon();break;case DOUBLE_HOOK_NUMBER:case GUN_NUMBER:e.shooting=!1,deleteStoppedWeapons()}player.score+=10*balloons[t].size.radius,splitBalloon(balloons[t])}}function squareDistanceBetweenPoints(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}function isBalloonBetweenRectangleX(e,t){return e.center.x>t.position.x&&e.center.x<t.position.x+t.width}function isBalloonBetweenRectangleY(e,t){return e.center.y>=t.position.y&&e.center.y<=t.position.y+t.height}function isBalloonNearObject(e,t){return!(e.center.x<t.position.x-e.size.radius||e.center.x>t.position.x+t.width+e.size.radius||e.center.y<t.position.y-e.size.radius||e.center.y>t.position.y+t.height+e.size.radius)}function isInHorizontalCollision(e,t){var i=!1;return isBalloonBetweenRectangleX(e,t)&&e.center.y+e.size.radius>=t.position.y+3&&e.center.y-e.size.radius<=t.position.y+t.height-3&&(i=!0),i}function isInVerticalCollision(e,t){var i=!1;return isBalloonBetweenRectangleY(e,t)&&e.center.x+e.size.radius>=t.position.x+5&&e.center.x-e.size.radius<=t.position.x-5+t.width&&(i=!0),i}function isBalloonCollidingBottomRightCorner(e,t){let i={x:t.position.x+t.width,y:t.position.y+t.height};return squareDistanceBetweenPoints(e.center,i)<=e.size.radius*e.size.radius}function isBalloonCollidingTopRightCorner(e,t){let i={x:t.position.x+t.width,y:t.position.y};return squareDistanceBetweenPoints(e.center,i)<=e.size.radius*e.size.radius}function isBalloonCollidingTopLeftCorner(e,t){let i={x:t.position.x,y:t.position.y};return squareDistanceBetweenPoints(e.center,i)<=e.size.radius*e.size.radius}function isBalloonCollidingBottomLeftCorner(e,t){let i={x:t.position.x,y:t.position.y+t.height};return squareDistanceBetweenPoints(e.center,i)<=e.size.radius*e.size.radius}function keepBalloonOutsideObjects(e,t){if(t.exist){var i=!1;if(isBalloonNearObject(e,t))if(isInHorizontalCollision(e,t))e.center.y<t.position.y?e.velocity.y>3?e.velocity.y*=-1:e.velocity.y=-3:e.velocity.y*=-1,i=!0;else if(isInVerticalCollision(e,t))e.velocity.x*=-1,i=!0;else if(isBalloonCollidingTopLeftCorner(e,t)){function o(e){return-(e-t.position.x)+t.position.y}i=!0,e.center.y>o(e.center.x)?e.velocity.x*=-1:e.velocity.y*=-1}else if(isBalloonCollidingTopRightCorner(e,t)){function o(e){return e-t.position.x-t.width+t.position.y}i=!0,e.center.y>o(e.center.x)?e.velocity.x*=-1:e.velocity.y*=-1}else if(isBalloonCollidingBottomLeftCorner(e,t)){function o(e){return e-t.position.x+t.position.y+t.height}i=!0,e.center.y<o(e.center.x)?e.velocity.x*=-1:e.velocity.y*=-1}else if(isBalloonCollidingBottomRightCorner(e,t)){function o(e){return e-t.position.x-t.width+t.position.y+t.height}i=!0,e.center.y<o(e.center.x)?e.velocity.x*=-1:e.velocity.y*=-1}}return i}function collisionsAngles(e,t){return isBalloonCollidingBottomLeftCorner(e,t)||isBalloonCollidingBottomRightCorner(e,t)||isBalloonCollidingTopLeftCorner(e,t)||isBalloonCollidingTopRightCorner(e,t)}function collisionsWithPlayer(e,t){var i=collisionsAngles(e,t).collision,o=isInVerticalCollision(e,t),s=isInHorizontalCollision(e,t);return i||s||o}function createItem(e){e.size.number>0&&(items[items.length]={type:Math.floor(Math.random()*MAX_ITEM)+1,position:{x:e.center.x,y:e.center.y},height:40,width:40,time:0})}function splitBalloon(e){if(e.size.number>1){var t,i=e;switch(e.size.number){case 4:t=.66;break;case 3:t=.75;break;case 2:t=1}balloons[balloons.length]={center:{x:i.center.x-10,y:i.center.y-6},size:BALLOON_SIZE[i.size.number-1],velocity:{x:-t,y:-2},gravity:{x:0,y:9.81/1e3}},balloons[balloons.length]={center:{x:i.center.x+10,y:i.center.y-4},size:BALLOON_SIZE[i.size.number-1],velocity:{x:t,y:-2},gravity:{x:0,y:9.81/1e3}},Math.random()<.66&&createItem(i)}e.size=BALLOON_SIZE[0]}function playerTouchItem(){for(var e=0;e<items.length;e++)if(-1!=items[e].type&&(items[e].position.x>player.position.x&&items[e].position.x<player.position.x+player.width||items[e].position.x+items[e].width>player.position.x&&items[e].position.x+items[e].width<player.position.x+player.width)&&(items[e].position.y>player.position.y&&items[e].position.y<player.position.y+player.height||items[e].position.y+items[e].height>player.position.y&&items[e].position.y+items[e].height<player.position.y+player.height))switch(player.score+=50,items[e].type){case GRAPPLE_HOOK_ITEM:case DOUBLE_HOOK_ITEM:case TRIDENT_ITEM:case GUN_ITEM:player.powerOn=items[e].type,items[e].type=-1;break;case TIMER_BOOST_ITEM:timer+=10,items[e].type=-1;break;case DYNAMITE_ITEM:dynamiteExplode(),items[e].type=-1;break;case FREEZE_ITEM:areBalloonsFreeze=!0,balloonsFreezeTimer=Date.now(),items[e].type=-1,balloonBlinkTimer=Date.now();break;case SHIELD_ITEM:player.shieldOn=!0,items[e].type=-1}}function dynamiteExplode(){for(var e=!0;e;){e=!1;for(var t=0;t<balloons.length;t++)if(balloons[t].size.number>1){player.score+=10*balloons[t].size.radius;var i=balloons[t];balloons[balloons.length]={center:{x:i.center.x-3,y:i.center.y},size:BALLOON_SIZE[i.size.number-1],velocity:{x:-1,y:-2+Math.random()},gravity:{x:0,y:9.81/1e3}},balloons[balloons.length]={center:{x:i.center.x+3,y:i.center.y},size:BALLOON_SIZE[i.size.number-1],velocity:{x:1,y:-2+Math.random()},gravity:{x:0,y:9.81/1e3}},Math.random()<.34&&createItem(i),balloons[t].size=BALLOON_SIZE[0],e=!0}}}function init(){(context=document.getElementById("cvs").getContext("2d")).width=document.getElementById("cvs").width,context.height=document.getElementById("cvs").height,levelInitialization(1),document.body.onblur=function(){isOnFocus=!1},document.body.onfocus=function(){isOnFocus=!0},document.addEventListener("keydown",captureKeyboardPress),document.addEventListener("keyup",captureKeyboardReleased),document.addEventListener("click",captureClicSouris),gameLoop()}function gameLoop(){var e=Date.now()-lastUpdate;lastUpdate=Date.now(),!isOnFocus||pause?(document.title="Pang - en pause",context.fillStyle="black",context.fillText("PAUSE",500,300)):(victory||defeat)&&numLevel>0?(document.title=victory?"Pang - gagné !":"Pang - perdu...",render()):(document.title="Pang",update(e),render()),requestAnimationFrame(gameLoop)}function update(e){if(timer-=e/1e3,Date.now()-shieldTimer>3e3&&(isInvincible=!1),areBalloonsFreeze)isInvincible=!0,Date.now()-balloonsFreezeTimer>5e3&&(areBalloonsFreeze=!1,isInvincible=!1);else{for(var t=0;t<balloons.length;t++)if(balloons[t].size.number>0){if(balloons[t].velocity.x+=balloons[t].gravity.x*e,balloons[t].velocity.y+=balloons[t].gravity.y*e,newballoon={center:{x:balloons[t].center.x,y:balloons[t].center.y},size:balloons[t].size,velocity:{x:balloons[t].velocity.x,y:balloons[t].velocity.y},gravity:{x:balloons[t].gravity.x,y:balloons[t].gravity.y}},newballoon.center.x+=balloons[t].velocity.x*e*BALLOON_SPEED,newballoon.center.y+=balloons[t].velocity.y*e*BALLOON_SPEED,!keepBalloonWithinBorders(newballoon))for(var i=!1,o=0;o<platforms.length&&!i;)i=keepBalloonOutsideObjects(newballoon,platforms[o]),o++;i||(balloons[t].center.x=newballoon.center.x,balloons[t].center.y=newballoon.center.y),balloons[t].velocity.x=newballoon.velocity.x,balloons[t].velocity.y=newballoon.velocity.y}for(t=0;t<balloons.length;t++)balloons[t].size.number}for(t=0;t<weapons.length;t++){if(1==weapons[t].shooting)switch(weapons[t].type){case GRAPPLE_HOOK_NUMBER:case DOUBLE_HOOK_NUMBER:case TRIDENT_NUMBER:weapons[t].length+=HOOK_SPEED*e;break;case GUN_NUMBER:weapons[t].position.y-=BULLET_SPEED*e}else weapons[t].type==TRIDENT_NUMBER&&(weapons[t].time+=e/1e3);stopWeapon(weapons[t])}for(t=0;t<items.length;t++)-1!=items[t].type&&isNotOnPlatformOrGround(items[t])&&items[t].position.y+items[t].height<cvs.height?items[t].position.y=items[t].position.y+GRAVITY.y*e/1e4:(items[t].time+=e/1e3,items[t].time>4&&(items[t].type=-1));var s=player.position.x+player.speed.x*e/1e3,n=player.position.y+player.speed.y*e/1e3,l=player.speed.x+isGravity*GRAVITY.x*e/1e3,r=player.speed.y+isGravity*GRAVITY.y*e/1e3;-1!=findLadder(player)?n+player.height<ladders[findLadder(player)].position.y&&(n=ladders[findLadder(player)].position.y-player.height):n<player.position.y&&(n=player.position.y),isGravity=isNotOnPlatformOrGround(player)?1:0;var a=!1,y=-1;for(t=0;t<platforms.length;t++)isPlayerWithinObject(player,s,n,platforms[t])&&(a=!0,y=t);if(a&&(r<0&&platforms[y].position.y+platforms[y].height<=player.position.y?(n=platforms[y].position.y+platforms[y].height,r=0):(l>0?s=platforms[y].position.x-player.width:l<0&&(s=platforms[y].position.x+platforms[y].width),l=player.speed.x)),player.position.x=s,player.position.y=n,player.speed.x=l,player.speed.y=r,keepPlayerWithinBorder(),playerTouchItem(),isVictory()&&(victory=!0,player.score+=5*Math.floor(timer)),!victory)for(t=0;t<balloons.length;t++)isDefeat(balloons[t])&&(defeat=!0)}function render(){if(0==numLevel){var e,t,i,o,s;context.fillStyle="black",context.fillRect(0,0,context.width,context.height),context.drawImage(logo,(context.width-400)/2,50,400,290),context.font="bold 17px sans-serif",context.textBaseline="top";for(var n=0;n<5;n++)e=margin+n*(marginButton+widthButton),context.fillStyle="#E7DBD0",context.drawImage(buttons,e,400,widthButton,heightButton),context.drawImage(buttons,e,400+heightButton+40,widthButton,heightButton),i="Niveau "+(n+1),s="Niveau "+(n+6),t=e+(widthButton-context.measureText(i).width)/2,o=e+(widthButton-context.measureText(s).width)/2,context.fillStyle="#222222",context.fillText(i,t,400-(17-heightButton)/2),context.fillText(s,o,400+heightButton+40-(17-heightButton)/2);context.textBaseline="alphabetic"}else{context.clearRect(0,0,1080,608);var l="LEVEL "+numLevel;context.fillStyle="white",context.strokeStyle="black",context.lineWidth=1.6,context.font="bolder 30px Arial",context.fillText(l,context.width/2-context.measureText(l).width+60,40),context.strokeText(l,context.width/2-context.measureText(l).width+60,40);var r="TIME : ";Math.floor(timer)>10&&Math.floor(timer)<100?r+="0":Math.floor(timer)<10&&(r+="00"),r+=Math.floor(timer),context.fillStyle="white",context.strokeStyle="black",context.lineWidth=1.6,context.font="bolder 30px Arial",context.fillText(r,context.width-context.measureText(r).width-20,40),context.strokeText(r,context.width-context.measureText(r).width-20,40);var a="SCORE : "+player.score;context.lineWidth=1.3,context.font="bolder 23px Arial",context.fillText(a,20,30),context.strokeText(a,20,30);var y="LIVES : ";if(player.livesNumber>0)for(n=0;n<player.livesNumber;n++)y+="I";else y+="0";context.fillText(y,20,57),context.strokeText(y,20,57);for(n=0;n<platforms.length;n++)platforms[n].exist&&(platforms[n].isDestructible?context.fillStyle=DESTRUCTIBLE_PLATFORM_COLOR:context.fillStyle=PLATFORM_COLOR,context.fillRect(platforms[n].position.x,platforms[n].position.y,platforms[n].width,platforms[n].height));for(n=0;n<ladders.length;n++)context.drawImage(LADDERS_IMAGE,ladders[n].position.x,ladders[n].position.y,ladders[n].width,ladders[n].height);if(!areBalloonsFreeze||Date.now()-balloonBlinkTimer<4e3||(Date.now()-balloonBlinkTimer)%400<100)for(n=0;n<balloons.length;n++)balloons[n].size.number>0&&fillCircle(balloons[n]);for(n=0;n<items.length;n++)if(-1!=items[n].type)switch(items[n].time<2?context.fillStyle="white":items[n].time<3?context.fillStyle="darkgrey":context.fillStyle="black",context.beginPath(),context.arc(items[n].position.x+items[n].width/2,items[n].position.y+items[n].height/2,items[n].width/2,0,2*Math.PI),context.fill(),items[n].type){case GRAPPLE_HOOK_ITEM:context.fillStyle=GRAPPLE_HOOK_ITEM_COLOR,context.fillRect(items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case DOUBLE_HOOK_ITEM:context.drawImage(DOUBLE_HOOK_ITEM_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case TRIDENT_ITEM:context.drawImage(TRIDENT_ITEM_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case TIMER_BOOST_ITEM:context.drawImage(TIMER_BOOST_ITEM_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case DYNAMITE_ITEM:context.drawImage(DYNAMITE_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case FREEZE_ITEM:context.drawImage(FREEZE_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case SHIELD_ITEM:context.drawImage(SHIELD_ITEM_IMAGE,items[n].position.x,items[n].position.y,items[n].width,items[n].height);break;case GUN_ITEM:context.fillStyle="blue",context.fillRect(items[n].position.x,items[n].position.y,items[n].width,items[n].height)}for(n=0;n<weapons.length;n++)switch(weapons[n].type){case GRAPPLE_HOOK_NUMBER:context.fillStyle=GRAPPLE_HOOK_COLOR,context.fillRect(weapons[n].position.x,weapons[n].position.y,HOOK_WITDH,-weapons[n].length);break;case DOUBLE_HOOK_NUMBER:context.fillStyle="black",context.fillRect(weapons[n].position.x,weapons[n].position.y,HOOK_WITDH,-weapons[n].length),context.drawImage(DOUBLE_HOOK_IMAGE,weapons[n].position.x-5,weapons[n].position.y-weapons[n].length);break;case TRIDENT_NUMBER:weapons[n].time<1?context.fillStyle=TRIDENT_COLOR1:weapons[n].time<2?context.fillStyle=TRIDENT_COLOR2:context.fillStyle=TRIDENT_COLOR3,context.fillRect(weapons[n].position.x,weapons[n].position.y,HOOK_WITDH,5-weapons[n].length),context.drawImage(TRIDENT_IMAGE,weapons[n].position.x-20,weapons[n].position.y-weapons[n].length);break;case GUN_NUMBER:context.fillStyle="black",context.fillRect(weapons[n].position.x,weapons[n].position.y,HOOK_WITDH,-weapons[n].length)}easterEgg?context.drawImage(EASTER_BUNNY,player.position.x,player.position.y):victory?player_last_direction>0?context.drawImage(PLAYER_IMAGE_RIGHT,player.position.x,player.position.y):context.drawImage(PLAYER_IMAGE_LEFT,player.position.x,player.position.y):(!isInvincible||areBalloonsFreeze||(Date.now()-playerBlinkTimer)%500<250)&&(player.speed.x>0?(context.drawImage(PLAYER_IMAGE_RIGHT,player.position.x,player.position.y),player_last_direction=1):player.speed.x<0?(context.drawImage(PLAYER_IMAGE_LEFT,player.position.x,player.position.y),player_last_direction=-1):player_last_direction>0?context.drawImage(PLAYER_IMAGE_RIGHT,player.position.x,player.position.y):context.drawImage(PLAYER_IMAGE_LEFT,player.position.x,player.position.y),player.shieldOn&&context.drawImage(SHIELD_IMAGE,player.position.x,player.position.y)),victory&&drawFinalMessage("victory"),defeat&&(player.livesNumber>1?drawFinalMessage("defeat"):(player.livesNumber-=1,drawFinalMessage("defeat")))}}function captureKeyboardPress(e){if(0==numLevel)switch(e.keyCode){case 13:numLevel=1;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:levelInitialization(numLevel=e.keyCode-48)}else switch(e.keyCode){case 39:case 37:playerMove(e.keyCode);break;case 38:case 40:e.preventDefault(),playerMoveLadder(e.keyCode);break;case 77:numLevel=0;break;case 80:pause=!pause;break;case 32:e.preventDefault(),shootWeapon(player);break;case 13:defeat?player.livesNumber>0?(defeat=!1,levelInitialization(numLevel),player.livesNumber-=1):(defeat=!1,levelInitialization(numLevel),player.livesNumber=3,player.score=0):victory&&((numLevel+=1)>MAX_LEVEL&&(numLevel=0),victory=!victory,levelInitialization(numLevel))}e.ctrlKey&&(e.preventDefault(),e.altKey&&(e.preventDefault(),68==e.keyCode&&(easterEgg=!easterEgg,player.width=easterEgg?35:45)))}SHIELD_IMAGE.src="./assets/shield.png",playerMoveLadder=function(e){if(-1!=findLadder(player))switch(e){case 38:player.speed.y=-PLAYER_SPEED;break;case 40:player.speed.y=PLAYER_SPEED}},captureKeyboardReleased=function(e){switch(e.keyCode){case 39:case 37:playerStopMove(e.keyCode);break;case 38:case 40:playerStopMoveLadder()}},captureClicSouris=function(e){if(0==numLevel&&("cvs"==e.target.id&&(clic.x=e.pageX-cvs.offsetLeft,clic.y=e.pageY-cvs.offsetTop),(clic.y>=400&&clic.y<=440||clic.y>=480&&clic.y<=520)&&clic.x>=60&&clic.x<=cvs.width-60)){var t=detectLevelButton();t>0&&levelInitialization(numLevel=t)}};